---
import type { DatabaseObjectResponse } from "@notionhq/client/build/src/api-endpoints";
import BlogPageFooter from "../components/notion/blog/BlogPageFooter.astro";
import { getInfoForPage } from "../lib/notion/caches";
import { getPageTitleComponents } from "../lib/notion/titles";
import { richTextToUnformattedString } from "../lib/notion/util";
import NotionPageLayout from "./NotionPageLayout.astro";

export interface Props {
  page: DatabaseObjectResponse;
}

const { page } = Astro.props;

const info = await getInfoForPage(page.id);
const titleComponents = getPageTitleComponents(page);
const pageTitle = richTextToUnformattedString(titleComponents);
---

<NotionPageLayout
  page={page}
  meta={{
    title: pageTitle,
    url: info.path,
    rssUrl: "/blog/feed.xml",
    header: { seed: page.id, maskType: "waves", iconType: "none" },
  }}
  breadcrumbs={[
    { name: "Home", url: "/" },
    { name: "Blog", url: "/blog" },
    { name: pageTitle, url: info.path },
  ]}
>
  <slot />

  <BlogPageFooter page={page} slot="page-footer" />
</NotionPageLayout>
