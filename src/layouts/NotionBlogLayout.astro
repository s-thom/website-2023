---
import type { DatabaseObjectResponse } from "@notionhq/client/build/src/api-endpoints";
import BlogPageFooter from "../components/notion/blog/BlogPageFooter.astro";
import BlogPageHeader from "../components/notion/blog/BlogPageHeader.astro";
import { getUrlSlugForPage, richTextToUnformattedString } from "../lib/notion";
import PageLayout from "./PageLayout.astro";

export interface Props {
  page: DatabaseObjectResponse;
}

const { page } = Astro.props;

const pageSlug = getUrlSlugForPage(page);
const pageTitle = richTextToUnformattedString(
  (page.properties.Name as any).title,
);
const pageUrl = `/blog/${pageSlug}`;
---

<PageLayout
  meta={{ title: pageTitle, url: pageUrl, rssUrl: "/blog/feed.xml" }}
  breadcrumbs={[
    { name: "Home", url: "/" },
    { name: "Blog", url: "/blog" },
    { name: pageTitle, url: pageUrl },
  ]}
>
  <BlogPageHeader page={page} slot="page-header" />

  <article class="flow">
    <slot />
  </article>

  <BlogPageFooter page={page} slot="page-footer" />
</PageLayout>
