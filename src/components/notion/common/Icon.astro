---
import type { DatabaseObjectResponse } from "@notionhq/client/build/src/api-endpoints";
import type { GetImageResult } from "astro";
import { getImage, Image } from "astro:assets";

export interface Props {
  class?: string;
  icon: NonNullable<DatabaseObjectResponse["icon"]>;
}

const { class: className, icon } = Astro.props;

let image: GetImageResult | undefined;
switch (icon.type) {
  case "external":
    image = await getImage({ src: icon.external.url });
    break;
  case "file":
    image = await getImage({ src: icon.file.url });
    break;
  default:
    image = undefined;
}
---

{
  image ? (
    <Image
      class={className}
      src={image.src}
      alt=""
      width={0}
      height={0}
      {...image.attributes}
    />
  ) : (
    <span>{(icon as any).emoji}</span>
  )
}
