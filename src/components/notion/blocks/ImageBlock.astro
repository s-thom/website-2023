---
import type { ImageBlockObjectResponse } from "@notionhq/client/build/src/api-endpoints";
import { richTextToUnformattedString } from "../../../lib/notion/util";
import NotionImage from "../common/NotionImage.astro";
import RichText from "../common/RichText.astro";

export interface Props {
  block: ImageBlockObjectResponse;
}

const { block } = Astro.props;

const captionPlain = richTextToUnformattedString(block.image.caption);
---

<figure data-block={block.id} class="block-image">
  <NotionImage id={block.id} image={block.image} alt={captionPlain} />
  <figcaption class="block-image-caption">
    <RichText components={block.image.caption} />
  </figcaption>
</figure>

<style>
  .block-image {
    grid-column: var(--area-small-bleed) !important;
    padding: 0.5em;
    background-color: var(--color-alt-background);
    border-radius: var(--border-radius);
  }

  .block-image-caption {
    text-align: center;
    font-style: italic;
  }
</style>
